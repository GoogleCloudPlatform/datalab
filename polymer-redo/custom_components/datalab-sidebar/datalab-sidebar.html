<link rel="import" href="../sidebar-button/sidebar-button.html">
<link rel="import" href="../../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">

<dom-module id="datalab-sidebar">
  <template>
    <style>
      paper-drawer-panel {
        --paper-drawer-panel-left-drawer-container: {
          background-color: #eee;
        };
      }
      .content-panel {
        padding: 10px;
        margin: 0px;
      }
    </style>
    <paper-drawer-panel drawer-width="100px">
      <div slot="drawer">
        <sidebar-button id="files" title="Files" icon="editor:insert-drive-file">
        </sidebar-button>
        <sidebar-button id="data" title="Data" icon="view-quilt">
        </sidebar-button>
        <sidebar-button id="sessions" title="Sessions" icon="av:featured-play-list">
        </sidebar-button>
        <sidebar-button id="ungit" title="Ungit" icon="icons:code">
        </sidebar-button>
        <sidebar-button id="terminals" title="Terminals" icon="hardware:computer">
        </sidebar-button>
      </div>
      <div slot="main" class="content-panel"> Main panel... </div>
    </paper-drawer-panel>
  </template>
</dom-module>

<script>
  class SidebarElement extends Polymer.Element {

    static get is() { return "datalab-sidebar"; }

    static get properties() {
      return {
        selected: {
          type: String,
          value: "",
          observer: '_selectedChanged'
        }
      }
    }

    ready() {
      super.ready();
      document.addEventListener('sidebarButtonClicked', e => {
        this.selected = e.detail;
      });
    }

    _selectedChanged() {
      // first, apply css class to selected button, and remove it from all others
      let buttons = this.shadowRoot.querySelectorAll('sidebar-button');
      buttons.forEach(button => {
        if (button.id == this.selected) {
          button.setAttribute('selected', '');
        } else {
          button.removeAttribute('selected');
        }
      });

      // then dispatch an event to parent element with the selected page name
      let e = new CustomEvent('sidebarPageSelected', {
        bubbles: true,
        composed: true,
        detail: this.selected
      });
      this.shadowRoot.ownerDocument.dispatchEvent(e);
    }

  }
  customElements.define(SidebarElement.is, SidebarElement);
</script>
